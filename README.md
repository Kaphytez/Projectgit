# Проект X

## Описание:

Проект X - это консольное приложение на Python для обработки финансовых транзакций. Он позволяет фильтровать транзакции по статусу, сортировать их по дате, генерировать описания транзакций, маскировать конфиденциальные данные счетов и карт, а также конвертировать суммы транзакций в рубли, используя внешний API для получения курсов валют.

## Установка:

1.  Убедитесь, что у вас установлен Python 3.7 или выше.
2.  Клонируйте репозиторий:

    ```bash
    git clone https://github.com/Kaphytez/Project.git
    cd Project
    ```
3.  Создайте и активируйте виртуальное окружение (рекомендуется):

    ```bash
    python -m venv venv
    source venv/bin/activate  # Для Linux/macOS
    venv\Scripts\activate.bat  # Для Windows
    ```

4.  Установите необходимые зависимости:

    ```bash
    pip install -r requirements.txt  # Если у вас есть requirements.txt
    # или
    pip install pytest pytest-cov python-dotenv requests pytest-mock  # Если у вас нет requirements.txt
    ```

5.  Создайте файл `.env` в корне проекта и добавьте туда свой API-ключ (получите его на сайте [https://apilayer.com/marketplace/exchangerates_data](https://apilayer.com/marketplace/exchangerates_data) или аналогичном сервисе):

    ```
    EXCHANGE_RATES_API_KEY=YOUR_API_KEY
    EXCHANGE_RATES_BASE_URL=https://api.apilayer.com/exchangerates_data/
    ```

    **Внимание:** Никогда не храните API-ключи в коде! Используйте переменные окружения.

## Использование:

1.  Запустите приложение, выполнив файл `main.py`:

    ```bash
    python main.py
    ```

2.  Следуйте инструкциям в консоли для выбора операций:

    *   Вывод последних 5 транзакций (отсортированных по дате).
    *   Фильтрация транзакций по валюте.
    *   Генерация номеров карт.
    *   Вывод описаний всех транзакций.
    *   Узнать текущий курс валюты (используется внешний API).
    *   Выход.

## Файлы проекта

В корневой директории проекта находятся следующие файлы:

*   `main.py`: Основной файл приложения. Содержит логику выбора операций, обработки пользовательского ввода и вызова соответствующих функций.
*   `operations.json`: Файл с данными о транзакциях в формате JSON.

В директории `src/` находятся следующие модули:

*   `external_api.py`: Модуль для взаимодействия с внешним API курсов валют. Содержит функции для получения курса валют и конвертации суммы транзакции в рубли.
*   `generators.py`: Модуль, содержащий генераторы для создания случайных данных (например, номеров карт).
*   `masks.py`: Модуль, содержащий функции для маскировки конфиденциальных данных (номеров счетов и карт).
*   `processing.py`: Модуль, содержащий функции для фильтрации и сортировки транзакций.
*   `utils.py`: Модуль, содержащий вспомогательные функции, например, для чтения данных о транзакциях из JSON-файла.

## Тестирование

Этот проект использует `pytest` для автоматизированного тестирования. Тесты организованы в папке `tests`.

### Модульное тестирование

Основные компоненты:

*   `test_main.py`: Содержит тесты для проверки основной логики приложения, включая обработку пользовательского ввода и вызов соответствующих функций.
*   `test_external_api.py`: Содержит тесты для проверки функций взаимодействия с внешним API в файле `src/external_api.py`. Проверяет успешное получение курса валют и обработку ошибок API.
*   `test_processing.py`: Содержит тесты для проверки функций фильтрации и сортировки транзакций в файле `src/processing.py`.
*   `test_utils.py`: Содержит тесты для проверки функций `utils.py`.
*   `test_widget.py`: Содержит тесты для проверки функций форматирования и маскировки данных в файле `src/widget.py`.
*   `test_masks.py`: Содержит тесты для проверки функций маскировки счетов и карт в файле `src/masks.py`.
*   `test_generators.py`: Содержит тесты для проверки генераторов, используемых для создания случайных данных (например, номеров карт) в файле `src/generators.py`.

### Подход к тестированию:

*   **Фикстуры:** Фикстуры используются для подготовки тестовых данных, мокирования ввода/вывода и обеспечения консистентного состояния тестов. Определены в `tests/conftest.py`.
*   **Параметризация:** Некоторые тесты используют параметризацию для проверки функций с различными наборами входных данных, что позволяет более эффективно тестировать граничные случаи и различные сценарии.
*   **Модульность:** Тесты разработаны с учетом принципа модульности, где каждый модуль (файл) тестируется изолированно, чтобы упростить выявление и исправление ошибок.
*   **Мокирование:** Используется мокирование для изоляции тестов от внешних зависимостей, таких как API курсов валют.
*   **Покрытие кода:** Применяется инструмент `pytest-cov` для измерения покрытия кода тестами, что позволяет убедиться, что большая часть кода приложения протестирована.

### Запуск тестов:

Для запуска тестов используйте команду:

```bash
pytest